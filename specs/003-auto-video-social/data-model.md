# Data Model: TikTok Video Prompt Generator

**Feature**: 003-auto-video-social  
**Date**: 2025-11-26

## Entities

### 1. Tool (Existing - Read Only)

Source: `PLATFORM_TOOLS` in `app/components/tool-selector.tsx`

```typescript
interface Tool {
  platform: string; // e.g., "tiktok", "instagram"
  name: string; // Translation key, e.g., "scriptWriter.title"
  href: string; // URL path, e.g., "/tiktok/script-writer"
  slug: string; // Derived from href, e.g., "script-writer"
  description?: string; // From translation: `${slug}.description`
}
```

**Notes**:

- Read-only, no modifications needed
- ~100+ tools across 18 platforms
- Description fetched via translation key pattern

### 2. VideoPrompt (Generated - Session State)

```typescript
interface VideoPrompt {
  toolPlatform: string; // Platform of selected tool
  toolSlug: string; // Slug of selected tool
  toolName: string; // Translated tool name
  promptText: string; // Generated Veo 2 prompt
  language: "en" | "es"; // Prompt language
  generatedAt: Date; // Timestamp
}
```

**Notes**:

- Not persisted, lives in React state
- Generated by DeepSeek API
- One active prompt at a time

### 3. UploadedVideo (Client State)

```typescript
interface UploadedVideo {
  file: File; // Original file object
  objectUrl: string; // URL.createObjectURL result
  fileName: string; // Original filename
  duration?: number; // Video duration in seconds
  isValid: boolean; // Passes validation
  validationError?: string; // Error message if invalid
}
```

**Notes**:

- Client-side only, never uploaded to server
- Object URL used for preview and download
- Validation: MP4 format, max 60s duration

### 4. TikTokCaption (Generated - Session State)

```typescript
interface TikTokCaption {
  toolPlatform: string; // Platform of tool
  toolSlug: string; // Tool slug
  captionText: string; // Full caption with formatting
  hashtags: string[]; // Array of hashtags (without #)
  toolUrl: string; // Full URL to tool
  language: "en" | "es"; // Caption language
  isEdited: boolean; // User has modified
  generatedAt: Date; // Timestamp
}
```

**Notes**:

- Generated by DeepSeek API
- Editable by admin before copying
- Hashtags stored separately for easy manipulation

### 5. WorkflowState (UI State)

```typescript
type WorkflowStep = "select" | "prompt" | "upload" | "caption" | "ready";

interface WorkflowState {
  currentStep: WorkflowStep;
  selectedTool: Tool | null;
  prompt: VideoPrompt | null;
  video: UploadedVideo | null;
  caption: TikTokCaption | null;
  isLoading: boolean;
  error: string | null;
}
```

**Notes**:

- Controls UI flow and step progression
- Reset when starting new workflow

## State Transitions

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  [START] ──► SELECT TOOL ──► GENERATE PROMPT               │
│                    │              │                         │
│                    ▼              ▼                         │
│              Tool selected   Prompt ready                   │
│                    │              │                         │
│                    └──────────────┘                         │
│                           │                                 │
│                           ▼                                 │
│                    UPLOAD VIDEO                             │
│                           │                                 │
│                           ▼                                 │
│                    Video validated                          │
│                           │                                 │
│                           ▼                                 │
│                  GENERATE CAPTION                           │
│                           │                                 │
│                           ▼                                 │
│                    Caption ready                            │
│                           │                                 │
│                           ▼                                 │
│                    READY TO PUBLISH                         │
│                           │                                 │
│                           ▼                                 │
│              [Copy Caption + Download Video]                │
│                           │                                 │
│                           ▼                                 │
│                    [START OVER]                             │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## Validation Rules

### Video Upload Validation

| Rule     | Constraint   | Error Message Key                          |
| -------- | ------------ | ------------------------------------------ |
| Format   | MP4 only     | `admin.videoGenerator.error.invalidFormat` |
| Duration | ≤ 60 seconds | `admin.videoGenerator.error.tooLong`       |
| Size     | ≤ 100MB      | `admin.videoGenerator.error.tooLarge`      |

### Tool Selection Validation

| Rule     | Constraint                     | Error Message Key                        |
| -------- | ------------------------------ | ---------------------------------------- |
| Required | Must select tool               | `admin.videoGenerator.error.noTool`      |
| Exists   | Tool must be in PLATFORM_TOOLS | `admin.videoGenerator.error.invalidTool` |

## No Database Changes

This feature does not require any Appwrite collections or database schema changes. All data is:

- Read from existing sources (PLATFORM_TOOLS, translations)
- Generated on-demand (prompts, captions)
- Stored in client-side React state
- Not persisted between sessions

**Future Enhancement**: Could add `VideoHistory` collection to track generated videos, but out of scope for MVP.
